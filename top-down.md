# top-down

## 第一章：提纲

### 互联网的结构和ISP

- 端系统通过**接入ISPs**连接到互联网。

- Q：给定数百万ISP，如何将他们互联

	1. 两两互联--**不可拓展**

	2. 接入global ISP //如果全局ISP可行，会形成不同的全局ISP相互竞争（compete）和合作。

	3. ISP之间的连接可以通过Internet exchange point（IXP），多个ISP可以在这里对等。也可以通过POP，高级ISP接入低级ISP（若一个低级ISP接入多个高级ISP，**称之为多宿-multi home**）。可以通过ICP自己部署专用网络，同时和各级别ISP互联。

		

内容提供商网络（ICP）可能会构建自己的网络，让自己的服务和内容更加**靠近端用户**，提供更优质的服务同时降低运营成本。

**中心：第一次ISP**（如UUNET ，Sprint） 覆盖全球

**第二层ISP**：区域性ISP

### 分组延时，丢失和吞吐量

#### Q:分组丢失和延时是怎么发生的？

1. 节点处理延时
2. 分组到达链路的速率超过了链路的传输能力.(需要排队)
3. 传输延时（分组发送需要是时间L/R（分组长度/带宽））
4. 传播延时（电磁波传播时间）（近距离可以忽略不计） 

丢包：流量强度大于等于1时就会丢包，分组队列溢出

#### Traceroute

1. Traceroute是一个简单的应用程序，用于检测往返延时
2. 具体：假设源和目的地之间有**N-1**台路由器，则源发送**N**个特殊分组，路径上的路由器接收到特殊分组会向源回报一个短报文{路由器名字，地址}。

#### 吞吐量

1. 吞吐量取决于路径上的最小吞吐量链路（瓶颈链路）（短板效应）。



  

###  协议层次 

​	服务和服务访问点

- 服务（Service）：底层实体向上层实体提供他们之间通信的能力
- 原语（primitive）：上层使用下层服务的形式，高层使用低层提供的服务，以及低层向高层提供服务都是通过服务访问原语来进行交互的。
- 服务访问点SAP（Service Access Point）：上层使用下层提供的服务通过层间的接口---地点：如邮箱，地址（address），又如传输层的SAP：端口（port）

​	服务的类型

1. 有连接（建立握手关系，做准备）
2. 无连接

​	

#### 	数据单元（DU）

​		SDU（service data unit）

​		.......

<img src="https://i.328888.xyz/2023/03/08/5YQpL.png" alt="5YQpL.png" border="0" />

名称的规范

-   应用层：报文（message）
- 传输层：报文段：TCP段  UOP数据报
- 网络层：分组packet（无连接方式：数据报 datagram）
- 数据链路层： 帧（frame）
- 物理层：位（bit）



分层处理和实现复杂系统的好处--对付复杂系统

1. 概念化
2. 结构化：模块化更利于维护和升级
3. 但是效率会有所降低

#### Internet 协议栈

- 物理层：物理层将信号转换为物理信号
- 链路层：相邻两点间传输以帧为单位的数据
- 网络层：选择路由，主机到主机的通信（p2p），不可靠
- 传输层：进程到进程的区分，可靠的通信
- 应用层：网络应用(HTTP等)

<img src="https://i.328888.xyz/2023/03/08/5uuqy.png" alt="5uuqy.png" border="0" />



#### ISO/OSI

<img src="https://i.328888.xyz/2023/03/08/SZ1kc.png" alt="SZ1kc.png" border="0" />

互联网协议栈中的表示层和会话层由应用层的子层去实现



#### 封装和解封装

发送方：逐层封装   接受方：逐层解封

数据到达路由器（网络交换设备）要进行三层的解封装和三层的再封装；

数据到达交换机（链路设备）要进行二层的解封装和二层的再封装；

数据到达目标主机要进行五层的解封装。

<img src="https://i.328888.xyz/2023/03/08/SiS1z.png" alt="SiS1z.png" border="0" />



### Internet 历史

略

## 第二章：应用层

- 传输层服务模型
- 客户-服务器模式
- 对等模式（peer to peer p2p）
- 内容分发网络



### 应用层协议原理

一些网络应用的例子：Email  Web 流媒体 网络游戏...

可能的应用架构

1. C/S架构
2. 





